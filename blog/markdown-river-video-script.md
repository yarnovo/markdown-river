# Markdown River 视频字幕稿 - 彻底解决 AI 流式输出闪烁问题

## 开场（0:00 - 0:15）

大家好！今天我要给大家介绍一个困扰了无数开发者的问题，以及我们是如何彻底解决它的。

如果你正在开发 AI 应用，特别是像 ChatGPT 这样的流式输出界面，你一定遇到过这个让人抓狂的问题——文字闪烁。

## 问题演示（0:15 - 0:45）

让我先给大家演示一下这个问题。

【屏幕演示】
看，当 AI 输出这句话的时候："这是一个*重要*的发现"

注意看"重要"这两个字——

刚开始是普通文字，然后突然！变成了斜体。

这种突然的变化就是我们说的"闪烁"。

想象一下，如果 AI 正在输出一大段文字，里面有很多格式标记，那画面简直就像在蹦迪！

## 为什么会这样？（0:45 - 1:30）

那为什么会出现这种情况呢？

问题的根源在于 Markdown 的设计。

在 Markdown 里，一个星号可能是很多意思：

- 可能就是个普通的星号
- 可能是乘法符号，比如 5\*3=15
- 也可能是斜体标记的开始

关键是什么？关键是你必须看到后面有没有另一个星号，才能确定前面这个星号到底是什么意思！

这就像看悬疑片——你得看到结局才知道前面的线索是什么意思。

但问题是，AI 是一个字一个字输出的，它不会等到句子结束才显示给你看。

## 常见的解决方案都有问题（1:30 - 2:15）

那现在大家都是怎么解决的呢？

【方案一】先当普通文字，发现是格式标记再改
问题：改的时候就会闪

【方案二】加个延迟，等一等再渲染
问题：等多久？1秒？2秒？用户会觉得卡顿

【方案三】用复杂的规则去猜测
问题：再聪明的规则也有猜错的时候

所以你看，这些方案都是在"打补丁"，没有从根本上解决问题。

## 我们的解决思路（2:15 - 3:00）

那怎么办呢？

我们换了个思路——既然 Markdown 的问题无法根本解决，那就不用 Markdown！

让 AI 直接输出 HTML。

看看区别：

Markdown：`*重要*`
HTML：`<em>重要</em>`

HTML 的好处是什么？它"说话算话"！

看到 `<em>` 标签，马上就知道：哦，接下来是斜体文字。
不需要等，不需要猜，更不需要改！

## 效果对比（3:00 - 3:30）

让我们对比一下效果：

【并排演示两种输出方式】

左边是 Markdown：

- 输出星号 → 显示星号
- 输出"重" → 还是普通文字
- 输出"要" → 依然是普通文字
- 输出第二个星号 → 突然变斜体！（闪烁）

右边是 HTML：

- 输出 `<em>` → 知道要斜体了
- 输出"重" → 直接显示斜体
- 输出"要" → 继续斜体
- 输出 `</em>` → 完美结束

看到了吗？HTML 从一开始就知道自己要干什么，不需要"改口"。

## 技术细节（3:30 - 4:15）

当然，HTML 也有个小问题需要处理。

比如 AI 可能会把一个标签分成几次发送：

- 第1次：`<str`
- 第2次：`<strong>`

这时候我们需要稍微等一下，等标签完整了再渲染。

但这个等待和 Markdown 的等待完全不同：

- Markdown 要等整句话
- HTML 只需要等一个标签（最多几个字符）

而且，前面已经显示的内容不会受影响，不会重新渲染。

## Markdown River 库介绍（4:15 - 4:45）

基于这个原理，我们开发了 Markdown River 这个库。

它能够：

- 完全消除流式输出的闪烁
- 支持 React、Vue、原生 JS
- 使用超级简单，一行代码搞定

【展示代码示例】

```javascript
const river = new MarkdownRiver();
river.write(chunk); // 就这么简单
```

## 实际效果演示（4:45 - 5:15）

让我给大家看看实际效果。

【演示各种复杂的 Markdown 内容】

- 代码块
- 列表
- 表格
- 图片
- 链接

看，完全没有闪烁！而且渲染速度和 AI 输出完全同步。

## 总结（5:15 - 5:45）

总结一下今天的内容：

1. AI 流式输出闪烁的根本原因是 Markdown 的歧义性
2. 传统的解决方案都是在"打补丁"
3. 我们通过让 AI 输出 HTML 从根本上解决了问题
4. Markdown River 库让这个方案变得简单易用

## 结尾（5:45 - 6:00）

如果你也在被这个问题困扰，欢迎试试 Markdown River。

GitHub 地址在视频简介里，完全开源免费。

感谢观看，我们下期再见！

---

## 字幕时间轴备注

- 0:00-0:15 开场白
- 0:15-0:45 问题演示（需要屏幕录制）
- 0:45-1:30 原因分析（配合动画说明）
- 1:30-2:15 现有方案的问题
- 2:15-3:00 新思路介绍
- 3:00-3:30 效果对比（并排演示）
- 3:30-4:15 技术细节
- 4:15-4:45 库介绍
- 4:45-5:15 实际演示
- 5:15-5:45 总结
- 5:45-6:00 结尾

## 视频制作建议

1. **视觉效果**：
   - 使用分屏对比展示 Markdown vs HTML 的区别
   - 用动画展示字符逐个输出的过程
   - 闪烁问题要用慢动作重点展示

2. **配音建议**：
   - 语速适中，重点内容可以稍微放慢
   - 在展示闪烁问题时可以加重语气
   - 技术细节部分保持清晰准确

3. **素材准备**：
   - 准备好各种 Markdown 格式的示例
   - 录制实际的闪烁效果
   - 准备 Markdown River 的使用演示

4. **字幕样式**：
   - 关键词用不同颜色高亮
   - 代码部分使用等宽字体
   - 重要观点可以加粗显示
